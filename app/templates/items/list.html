{% extends "base.html" %}
{% block content %}
<div class="topbar">
  <div>
    <h1 class="h1">Inventory</h1>
    <div class="sub">Items imported or created manually. Use filters to find items quickly.</div>
  </div>
  <div>
    <a class="btn primary" href="{{ url_for('routes.items_new') }}">Add item</a>
  </div>
</div>

<!-- Filters (Shopify-inspired) -->
<div class="card" style="margin-bottom:14px;">
  <div class="card-body">
    <form method="get" style="display:flex; gap:10px; align-items:end; flex-wrap:wrap;">
      <div class="field" style="min-width:200px;">
        <label>Status</label>
        <select name="status">
          <option value="" {% if not status %}selected{% endif %}>All</option>
          <option value="IN_STOCK" {% if status=='IN_STOCK' %}selected{% endif %}>IN_STOCK</option>
          <option value="SOLD" {% if status=='SOLD' %}selected{% endif %}>SOLD</option>
        </select>
      </div>

      <div class="field" style="min-width:320px; flex:1;">
        <label>Search (SKU, Item ID, Order #, Description)</label>
        <input name="q" value="{{ q or '' }}" placeholder="e.g. SR-PRZE or MM-0001 or PO-123">
      </div>

      <div style="display:flex; gap:10px;">
        <button class="btn primary" type="submit">Apply</button>
        <a class="btn" href="{{ url_for('routes.items_list') }}">Clear</a>
      </div>
    </form>
  </div>
</div>

<div class="card">
  <div class="card-header">
    <div class="card-title">Latest items</div>
  </div>

  <div class="card-body table-wrap">
    <table>
      <thead>
        <tr>
          <th>Status</th>
          <th>User Item ID</th>
          <th>SKU</th>
          <th>Description</th>
          <th>Order #</th>
          <th>Arrival</th>
          <th>Net cost</th>
          <th>Freight</th>
          <th style="text-align:right;">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for i in items %}
        <tr>
          <td>
            {% if i.status == 'IN_STOCK' %}
              <span class="badge green">IN_STOCK</span>
            {% else %}
              <span class="badge gray">SOLD</span>
            {% endif %}
          </td>
          <td>{{ i.user_item_id }}</td>
          <td>{{ i.sku }}</td>
          <td>{{ i.item_description }}</td>
          <td>{{ i.order_number }}</td>
          <td>{{ i.arrival_date }}</td>
          <td>€{{ i.net_unit_cost }}</td>
          <td>€{{ i.freight_net }}</td>
          <td style="text-align:right;">
            <div style="display:inline-flex; gap:8px;">
              <a class="btn" href="{{ url_for('routes.items_view', pk_id=i.pk_id) }}">View</a>
              <a class="btn" href="{{ url_for('routes.items_edit', pk_id=i.pk_id) }}">Edit</a>
            </div>
          </td>
        </tr>
        {% endfor %}

        {% if not items %}
        <tr>
          <td colspan="9" style="color: var(--muted);">
            No items found. Try changing filters or click “Add item”.
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
